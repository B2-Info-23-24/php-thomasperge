{# dashboard.twig #}
{% extends "/templates/default.html.twig" %}

{% block title %}Dashboard Page
{% endblock %}

{% block content %}
	{# NavBar #}
	{% include '/templates/components/navbar.twig' with {'homeUrl': '/', 'dashboardUrl': '/dashboard', 'profilUrl': '/profil', 'isAdmin': isAdmin} %}

	<div class="dasboard-container spacebox">
		{# Good Morning #}
		<div class="editor-container">
			<div class="spacebox">
				<div class="title">Good Morning,</div>
				<div class="username">{{ userData[0]['firstname'] }} {{ userData[0]['lastname'] }}</div>
			</div>

			<div class="spacebox">
				<a href="/submit" class="submit-button">Submit new car</a>
			</div>
		</div>

		{# All Collections #}
		<div class="all-cars">
			<div class="all-cars-title">ðŸ”¥ All your cars - Dashboard</div>
			<div class="all-cars-area">
				{% if vehicles is empty %}
					<div>Vous n'avez aucun vehicule</div>
				{% else %}
					{% for vehicle in vehicles %}
						{% include '/templates/components/card-vehicle-editing.twig' with {'id': vehicle.id, 'brand': vehicle.brand, 'model': vehicle.model, 'logo': vehicle.brand_logo, 'modelImage': vehicle.url_picture, 'seats': vehicle.nb_seats, 'petrol': vehicle.petrol, 'gear': vehicle.gearbox, 'price': vehicle.price} %}
					{% endfor %}
				{% endif %}
			</div>
		</div>

		{# All Booking #}
		<div class="all-cars">
			<div class="all-cars-title">ðŸŽ« All your booking - Dashboard</div>
			<div class="all-cars-area">
				{% if allBooking is empty %}
					<div>Vous n'avez aucune reservation</div>
				{% else %}
					{% for booking in allBooking %}
						{% set start_date_obj = booking.start_date|date("Y-m-d H:i:s")|date_modify('midnight') %}
						{% set finish_date_obj = booking.end_date|date("Y-m-d H:i:s")|date_modify('midnight') %}
						{% set date_diff = finish_date_obj.diff(start_date_obj) %}
						{% set days_diff = date_diff.days %}

						{% include '/templates/components/booking-car-card.twig' with {'bookingData': booking, 'days_diff': days_diff} %}
					{% endfor %}
				{% endif %}
			</div>
		</div>
	</div>
{% endblock %}
